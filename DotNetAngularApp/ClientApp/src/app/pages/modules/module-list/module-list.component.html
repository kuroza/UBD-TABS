<div class="row">
  <div class="col-md-8">
    <nb-card>
      <nb-card-body>
        <nb-tabset fullWidth>
          <nb-tab tabTitle="Module List"> <!-- active="{{ setActiveModuleList }}" -->
            <div>
              <nb-card-header style="border-bottom: none;">
                <h4 style="float: left;">Module List</h4>
                <div style="float: right;">
                  <label style="margin-right: 5px;">Filter semester:</label>
                  <nb-select filled placeholder="Select semester" [(selected)]="filter.semesterId"
                  (selectedChange)="onSemesterFilter()">
                    <nb-option *ngFor="let s of semesters" value="{{ s.id }}">{{ s.session }}</nb-option>
                  </nb-select>
                </div>
              </nb-card-header>
            </div>

            <table class="table table-hover" style="margin-top: 30px;">
              <thead>
                <tr>
                  <th style="width: 20%" scope="col">Module Code</th>
                  <th style="width: 70%" scope="col">Module Name</th>
                  <th style="width: 5%" scope="col"></th>
                  <th style="width: 5%" scope="col"></th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let offering of offerings">
                  <td (click)="selectModule(offering.module.id)">{{ offering.module.code }}</td>
                  <td (click)="selectModule(offering.module.id)">{{ offering.module.name }}</td>
                  <td><a href="javascript:void(0);" (click)="edit(offering.module.id)" *ngIf="hasAccess">
                      <nb-icon icon="edit-outline" status="warning" nbTooltip="Edit"></nb-icon>
                    </a></td>
                  <td><a href="javascript:void(0);" (click)="delete(offering.module.id)" *ngIf="hasAccess">
                      <nb-icon icon="trash-2-outline" status="danger" nbTooltip="Delete"></nb-icon>
                    </a></td>
                </tr>
              </tbody>
            </table>
            <div class="alert alert-danger" *ngIf="offerings == 0" style="margin-top: 20px; text-align: center;">
              Please select a semester
            </div>
          </nb-tab>

          <nb-tab tabTitle="Semester List">
            <nb-card-header style="border-bottom: none;">
              <h4>Semester List</h4>
            </nb-card-header>
          </nb-tab>

        </nb-tabset>
      </nb-card-body>
    </nb-card>
  </div>
  <div class="col-md-4">
    <nb-card *ngIf="hasAccess">
      <nb-card-body>
        <nb-tabset fullWidth>
          <nb-tab *ngIf="hasAccess" tabTitle="Module" active="{{ setActiveAddModule }}">
            <nb-alert status="danger" closable (close)="onClose()" *ngIf="existAlert" style="text-align: center;">
              {{error}}
            </nb-alert>
            <nb-alert status="warning" closable (close)="onClose()" *ngIf="requiredAlert" style="text-align: center;">
              Please enter the required fields!
            </nb-alert>
            <h4 *ngIf="module.id" style="margin-top: 10px;">Edit Module
              <button nbButton size="small" status="basic" ghost (click)="onClickBack()" nbTooltip="Return to Add"
                style="float: right;">
                <nb-icon icon="arrow-back-outline"></nb-icon>Back
              </button>
            </h4>
            <h4 *ngIf="!module.id" style="margin-top: 10px;">Add Module</h4>
            <form #f="ngForm" (ngSubmit)="submit()" novalidate>
              <div class="form-group" style="margin-top: 10px;">
                <label>Major *</label>
                <nb-select filled fullWidth placeholder="Select major" [(selected)]="module.majorId">
                  <nb-option *ngFor="let m of majors" value="{{ m.id }}">{{ m.name }}</nb-option>
                </nb-select>
              </div>
              <div style="margin-top: 10px;">
                <label>Module code *</label>
                <input id="code" type="text" class="form-control" [(ngModel)]="module.code" name="code"
                  placeholder="Module code">
              </div>
              <div style="margin-top: 10px;">
                <label>Module name *</label>
                <input id="name" type="text" class="form-control" [(ngModel)]="module.name" name="name"
                  placeholder="Module name">
              </div>
              <!-- <div style="margin-top: 10px;">
                <label>Lecturers *</label>
                <nb-select filled multiple fullWidth placeholder="Select lecturers" [(selected)]="module.lecturers">
                  <nb-option *ngFor="let l of lecturers" value="{{ l.id }}">{{ l.title }} {{ l.name }}</nb-option>
                </nb-select><br>
              </div> -->
              <div style="margin-top: 10px;">
                <button *ngIf="!module.id" nbButton fullWidth [disabled]="!f.valid">Add</button>
                <button *ngIf="module.id" nbButton fullWidth [disabled]="!f.valid">Save</button>
              </div>
              <!-- <div style="margin-top: 10px;">
                <button *ngIf="module.id" nbButton fullWidth status="basic">Back to add module</button>
              </div> -->
              <!-- <br><pre>{{ module | json }}</pre> -->
            </form>
          </nb-tab>

          <nb-tab *ngIf="hasAccess" tabTitle="Assign Modules" active="{{ setActiveAddAssignModules }}">
            <h4 style="margin-top: 10px;">Assign Module to a Semester</h4>
            <!-- 
              select semester
              select module code: name
              select lecturers
             -->
          </nb-tab>

          <nb-tab *ngIf="hasAccess" tabTitle="Semester" active="{{ setActiveSemester }}">
            <h4 style="margin-top: 10px;">Add Semester</h4>
            <!-- 
              semester session
              range datepicker
             -->
          </nb-tab>
        </nb-tabset>
      </nb-card-body>
    </nb-card>

    <nb-card>
      <nb-card-header>
        <h4>Details</h4>
      </nb-card-header>
      <nb-card-body>
        <div *ngIf="moduleDetails">
          <p>
            <span><b>Major:</b> {{ moduleDetails.module.major.name }}</span>
            <br>
            <span><b>Module code:</b> {{ moduleDetails.module.code }}</span>
            <br>
            <span><b>Module name:</b> {{ moduleDetails.module.name }}</span>
            <br>
          </p>

          <div class="card" style="width: 85%;">
            <div class="card-header">
              <h6>Lecturers</h6>
            </div>
            <ul class="list-group list-group-flush">
              <li *ngFor="let l of moduleDetails.lecturers" class="list-group-item">{{ l.title }} {{ l.name }}</li>
            </ul>
          </div>

          <div class="inline" *ngIf="hasAccess">
            <button nbButton status="warning" style="margin-top: 10px;" (click)="edit(moduleDetails.id)">Edit</button>
            <button nbButton status="danger" style="margin-left: 5px; margin-top: 10px;"
              (click)="delete(moduleDetails.id)">Delete</button>
          </div>
        </div>
        <div *ngIf="!moduleDetails" style="margin-top: 10px;">
          <nb-alert status="basic" closable (close)="onCloseDetails()" *ngIf="detailsAlert" style="text-align: center;">
            Click on table row to show its details
          </nb-alert>
        </div>
      </nb-card-body>
    </nb-card>
  </div>
</div>
