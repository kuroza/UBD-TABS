<nb-card>
  <nb-card-body>
    <h3>Booking list</h3>
  </nb-card-body>
</nb-card>
<nb-card>
  <nb-card-body>
    <p *ngIf="auth.loggedIn"> <!-- change to auth.authenticated() -->
      <button [routerLink]="['/pages/bookings/new']" class="btn btn-primary">New booking</button>
    </p>
    <div class="card card-body bg-light">
      <div class="form-inline">
        <div class="form-group mb-2">
          <label for="building">Filter building:</label>
        </div>
        <div class="form-group mx-sm-3 mb-2">
          <select name="building" id="" class="form-control" [(ngModel)]="query.buildingId" (change)="onFilterChange()">
            <option value=""></option>
            <option *ngFor="let b of buildings" value="{{ b.id }}">{{ b.name }}</option>
          </select>
        </div>
        <button class="btn btn-secondary mb-2" (click)="resetFilter()">Reset</button>
      </div>
    </div>
    <br>
    <table class="table">
      <thead class="thead-dark">
        <tr>
          <th *ngFor="let c of columns">
            <div *ngIf="c.isSortable" (click)="sortBy(c.key)">
              {{ c.title }}
              <i *ngIf="query.sortBy === c.key" 
                class="fa"
                [class.fa-sort-asc]="query.isSortAscending"
                [class.fa-sort-desc]="!query.isSortAscending"
              ></i>
            </div>
            <div *ngIf="!c.isSortable">
              {{ c.title }}
            </div>
          </th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let b of queryResult.items"> <!-- let b of bookings -->
          <td>{{ b.id }}</td>
          <td>{{ b.building.name }}</td>
          <td>{{ b.room.name }}</td>
          <td>{{ b.bookDate | date:'longDate' }}</td>
          <td>{{ b.contact.name }}</td>
          <td>
            <a [routerLink]="['/pages/bookings/', b.id]">View</a>
          </td>
        </tr>
      </tbody>
    </table>
    <pagination [total-items]="queryResult.totalItems" [page-size]="query.pageSize" (page-changed)="onPageChange($event)"></pagination>
  </nb-card-body>
</nb-card>
